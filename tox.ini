[tox]
envlist = py36


[testenv]
deps =
    -r{toxinidir}/requirements.txt
    pytest
    pytest-cov
    pytest-mock
commands =
    pytest -s \
        --cov-report html \
        --cov-report term \
        --cov python_releaser \
        {posargs}


[testenv:deps]
deps =
    pip-tools
commands =
    pip-compile --upgrade --output-file requirements.txt setup.py


[testenv:fmt]
deps =
    isort
    autopep8
commands =
    isort --recursive --atomic {posargs:python_releaser tests}
    autopep8 --recursive --in-place {toxinidir}


[testenv:lint]
deps =
    isort
    flake8
    twine>=1.12.0
commands =
    isort -rc -c --diff {posargs:python_releaser tests}
    flake8 --show-source --statistics {posargs:python_releaser tests}
    python setup.py sdist bdist_wheel
    twine check dist/*
